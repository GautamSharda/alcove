{% extends 'layout.njk' %}

{% block content %}

<div class="dashboard-body">
  <div class="ui grid" id="dashboard-header-grid">
    <div class="row" id="dashboard-header-row-top">
      <div class="eight wide column">
        <div id="dashboard-header-title">
          <h1 class="ui header"> Alcove Backup System: <br /> Machine Overview </h1>
        </div>
      </div>
      <div class="eight wide column">
        <div class="ui statistics" id="dashbaord-header-stats">
          <div class="green statistic">
            <div class="value">
              {{dashboard.successfulMachines}}
            </div>
            <div class="label" id="dashboard-header-stats-labels">
              Successful
            </div>
          </div>
          <div class="yellow statistic">
            <div class="value">
              {{dashboard.unsuccessfulMachines}}
            </div>
            <div class="label" id="dashboard-header-stats-labels">
              Partially Successful
            </div>
          </div>
          <div class="red statistic">
            <div class="value">
              {{dashboard.partialSuccessMachines}}
            </div>
            <div class="label" id="dashboard-header-stats-labels">
              Unsuccessful
            </div>
          </div>
          <div class="grey statistic">
            <div class="value">
              {{dashboard.idleMachines}}
            </div>
            <div class="label" id="dashboard-header-stats-labels">
              Idle
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="five column row">
      <div class="column">
        <div class="ui segment" id="dashboard-header-size">
          Total Size: <br /> <span class="dashboard-bold"> xxxx </span>
        </div>
      </div>
      <div class="column">
        <div class="ui segment" id="dashboard-header-size-max">
          Capacity: <br /> <span class="dashboard-bold"> xxxx </span>
        </div>
      </div>
      <div class="column">
        <div class="ui segment" id="dashboard-header-date-old">
          Oldest Backup: <br /> <span class="dashboard-bold"> {{dashboard.oldestBackupDate}} </span>
        </div>
      </div>
      <div class="column">
        <div class="ui segment" id="dashboard-header-date-new">
          Newest Backup: <br /> <span class="dashboard-bold"> {{dashboard.newestBackupDate}} </span>
        </div>
      </div>
      <div class="column">
        <div class="ui segment" id="dashboard-header-date-new">
          Last Summary Email: <br /> <span class="dashboard-bold"> {{dashboard.lastSummaryEmailDate}} </span>
        </div>
      </div>
    </div>
  </div>

  <table class="ui celled table" id="dashboard-table">
    <thead>
      <tr>
        <th class="dashboard-table-name">Machine Name</th>
        <th class="dashboard-table-status">Status</th>
        <th class="dashboard-table-size">Total Size</th>
        <th>Last Backup</th>
      </tr>
    </thead>
    <tbody>

      <tr>


      {% for machines in dashboard.machine %}

        <td> {{machines.name}} </td>

      {% if machines.totalBackups == 0 %}
      <td class="disabled">
      {% elif machines.totalBackups == machines.successfulBackups %}
      <td>
      {% elif machines.successfulBackups == 0 %}
      <td class="error">
      {% else %}
      <td class="warning">
      {% endif %}

         {% if machines.totalBackups > 0 and machines.successfulBackups == 0 %}<i class="attention icon"></i> {% endif %}  {{machines.successfulBackups}} of {{machines.totalBackups}} backups successful </td>
        <td> xxxx </td>
        <td> {{machines.timeSinceRestart}} ago </td>
      </tr>

      {% endfor %}

    </tbody>
  </table>
</div>

{% endblock %}